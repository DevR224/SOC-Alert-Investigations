# SOC175 â€“ PowerShell Found in Requested URL  
## Possible CVE-2022-41082 Exploitation Attempt

## ðŸ“Œ Alert Summary

This alert was triggered due to a PowerShell command detected inside a requested URL targeting an internal Exchange server. The activity aligns with exploitation attempts related to CVE-2022-41040 (SSRF) and CVE-2022-41082 (RCE).

The attack was blocked, but the activity was confirmed as malicious â€” making this a **True Positive**.

---

## ðŸ§¾ Log Details

- **Event ID:** 125  
- **Hostname:** Exchange Server 2  
- **Destination IP:** 172.16.20.8  
- **Source IP:** 58.237.200.6  
- **Log Source:** IIS  
- **HTTP Method:** GET  
- **User-Agent:** Mozilla/5.0 zgrab/0.x  
- **Action:** Blocked  
- **Alert Trigger Reason:** Request URL Contains PowerShell  

---

## ðŸš© Indicators of Compromise (IOCs)

### 1ï¸âƒ£ Suspicious Source IP =58.237.200.6

- Origin: External (Korea)
- Historical activity includes brute-force and unauthorized access attempts

---

### 2ï¸âƒ£ Malicious Request URL
- Origin: External (Korea)
- Historical activity includes brute-force and unauthorized access attempts

---

### 2ï¸âƒ£ Malicious Request URL
/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com
&Protocol=XYZ&FooProtocol=PowerShell


ðŸ”Ž Observations:
- Use of `autodiscover.json` endpoint (common in Exchange exploitation)
- Embedded PowerShell reference in URL
- Crafted parameters suggesting SSRF exploitation attempt
- Abuse of Exchange autodiscover functionality

---

### 3ï¸âƒ£ Exploitation Pattern

This behavior is consistent with:

- **CVE-2022-41040** â€“ Server-Side Request Forgery (SSRF)
- **CVE-2022-41082** â€“ Remote Code Execution via PowerShell

Attackers chain SSRF to reach internal Exchange services and execute PowerShell commands remotely.

---

## ðŸ”„ Traffic Flow

ðŸ”Ž Observations:
- Use of `autodiscover.json` endpoint (common in Exchange exploitation)
- Embedded PowerShell reference in URL
- Crafted parameters suggesting SSRF exploitation attempt
- Abuse of Exchange autodiscover functionality

---

### 3ï¸âƒ£ Exploitation Pattern

This behavior is consistent with:

- **CVE-2022-41040** â€“ Server-Side Request Forgery (SSRF)
- **CVE-2022-41082** â€“ Remote Code Execution via PowerShell

Attackers chain SSRF to reach internal Exchange services and execute PowerShell commands remotely.

---

## ðŸ”„ Traffic Flow
Internet (58.237.200.6) -> Exchange Server (172.16.20.8)


Direction: **Internet â†’ Company Network**

---

## ðŸ›¡ï¸ Impact Assessment

- Malicious PowerShell execution attempt detected
- IIS logs confirm exploitation behavior
- Security controls successfully blocked execution
- No evidence of compromise

**Attack Status:** Unsuccessful  
**Escalation Required:** No  
**Final Classification:** âœ… True Positive  

---

## ðŸ“š Key Takeaway

Even though the attack failed, it remains a **True Positive** because:

- A real exploitation attempt occurred
- The detection rule worked correctly
- Malicious intent was verified

A True Positive does not require a successful compromise â€” only confirmed malicious activity.

---
## ðŸ“ƒView FUll Walkthrough on my Blog
[Full Blog Walkthrough link](https://rideshcyber.hashnode.dev/soc175-walkthrough-powershell-found-in-requested-url-possible-cve-2022-41082-exploitation-walkthrough-eventid-125)

## ðŸ”Ž Learning Outcome

This alert reinforces a critical SOC principle:

> Detection accuracy is based on malicious intent and validated activity â€” not attacker success.

Blocking an attack does not make it a False Positive.

---
